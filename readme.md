# :rotating_light: 경고 :rotating_light:

현재 [작혼 Plus 사용시 계정 밴 사례](https://github.com/MajsoulPlus/majsoul-plus/issues/127)가 보고되었습니다.  
해당 문제가 해결될 때까지 본 프로젝트를 사용하지 않는 것을 권장드립니다.

[작혼 Plus](https://github.com/MajsoulPlus/majsoul-plus)를 사용하지 않고 한국어 리소스를 적용하시려면
[작혼 한국어 리소스](https://github.com/yf-dev/majsoul-korean-resources)를 사용해주세요.

---

작혼 Plus: 한국어 리소스 팩
========================

[![번역 현황](https://weblate.update.sh/widgets/majsoul-plus-korean-resource-pack/ko/master/svg-badge.svg)](https://weblate.update.sh/engage/majsoul-plus-korean-resource-pack/ko/?utm_source=widget)
![Build](https://github.com/yf-dev/majsoul-plus-korean/workflows/Build/badge.svg?branch=master)

![리소스 팩 썸네일](/data/translation/assets/en/extendRes/emo/e200005/4.png)

작혼 Plus: 한국어 리소스 팩은 [작혼 Plus](https://github.com/MajsoulPlus/majsoul-plus)에서 사용할 수 있는 리소스 팩으로, 다양한 요소를 한국어로 표시합니다.

(현재는 일부 리소스만 한국어로 표시합니다. 이후 다른 리소스의 한국어화 지원이 추가될 수 있습니다.)


### ⚠️ 주의사항 ⚠️

본 리소스 팩을 사용함에 따라 발생하는 모든 문제(예시: 계정 밴, 민사소송)에 대해 저희는 책임을 지지 않습니다.  
당신은 이 리소스 팩을 사용했을 경우 이러한 주의사항을 확인하고 동의한 것입니다.


### 1. 요구사양

- [작혼 Plus](https://github.com/MajsoulPlus/majsoul-plus) Version 2.0.0 이상
- 작혼 글로벌 서버 환경(작혼 Plus의 Settings에서 User Data의 Server to play 값을 2로 설정)


### 2. 적용방법

1. [릴리즈 페이지](https://github.com/yf-dev/majsoul-plus-korean/releases/latest)에서 `korean-<버전>.mspr`을 클릭하여 `작혼 Plus: 한국어 리소스 팩`을 다운로드합니다.
2. 작혼 Plus 런처를 실행하고, 좌측 Resource Packs 메뉴를 선택합니다.
3. 다운로드한 `korean-<버전>.mspr`을 작혼 Plus 런처 위로 끌어서 놓습니다.
4. 나타난 한국어 리소스 팩을 활성화합니다.


### 3. 업데이트

작혼의 버전이 업데이트되어 `ui_en.json`, `lqc.lqbin` 등의 파일의 구조가 변경될 경우 게임이 정상적으로 구동되지 않을 수 있습니다.

게임 로딩 화면에서 넘어가지 않거나, 검은 화면만 표시되는 증상이 나타날 경우 리소스 팩을 업데이트하여 문제가 해결될 가능성이 높습니다.

이러한 경우에는 다음과 같은 절차에 따라 업데이트를 시도하세요.  
(현재는 Windows 10 64비트 환경만을 지원합니다.)

1. 작혼 Plus 런처를 실행하고, 좌측 Resource Packs 메뉴를 선택합니다.
2. 우상단의 폴더 열기 아이콘을 클릭하여 리소스 팩 폴더를 엽니다.
3. 열린 리소스 팩 폴더에서 `update.bat` 을 실행합니다.
4. 실행한 프로그램이 종료(화면에 `[-] Update Completed. Press enter key to exit.`가 출력 후 아무 키 입력)되면, 작혼 Plus 런처에서 Resource Packs 상단의 새로고침 아이콘을 클릭합니다.
5. Launch Game 버튼을 눌러 작혼을 실행하고, 정상적으로 구동되는지 확인합니다.

만약 위 절차를 수행해도 정상적으로 동작하지 않는다면, 직접 에셋 갱신 작업을 시도해주세요.
에셋 갱신 작업은 위 업데이트 작업에서 `update.bat` 대신 `rebuild.bat` 를 실행하여 수행합니다.

위 절차를 모두 수행해도 게임이 정상적으로 구동되지 않는다면, 본 리소스 팩이 업데이트 될때까지 기다려주세요!


### 4. 리소스 미리보기

#### 4.1. 스크린샷

![스크린샷 1](/data/screenshots/1.png)
![스크린샷 2](/data/screenshots/2.png)
![스크린샷 3](/data/screenshots/3.png)
![스크린샷 4](/data/screenshots/4.png)
![스크린샷 5](/data/screenshots/5.png)
![스크린샷 5](/data/screenshots/6.png)

#### 4.2. 이모지

![](/data/translation/assets/en/extendRes/emo/e200001/1.png)
![](/data/translation/assets/en/extendRes/emo/e200001/4.png)
![](/data/translation/assets/en/extendRes/emo/e200002/0.png)
![](/data/translation/assets/en/extendRes/emo/e200002/7.png)
![](/data/translation/assets/en/extendRes/emo/e200005/4.png)
![](/data/translation/assets/en/extendRes/emo/e200006/3.png)
![](/data/translation/assets/en/extendRes/emo/e200006/5.png)
![](/data/translation/assets/en/extendRes/emo/e200017/7.png)
![](/data/translation/assets/en/extendRes/emo/e200018/2.png)
![](/data/translation/assets/en/extendRes/emo/e200019/0.png)
![](/data/translation/assets/en/extendRes/emo/e200019/3.png)
![](/data/translation/assets/en/extendRes/emo/e200020/2.png)


### 5. 개발 가이드

이하의 내용은 리소스 팩을 단순히 사용하는것이 아니라,
실제로 번역을 수정하거나 이 프로젝트를 개발하기 위한 내용입니다.

단순히 리소스 팩을 사용하시려면 `2. 적용방법` 항목을 읽어주세요.

#### 5.1. 요구사양

- Python 3.7
- [Pipenv](https://github.com/pypa/pipenv)

#### 5.2. 라이브러리 다운로드

```
cd data
pipenv install --dev
```

도커 환경에서 작업하시고자 하는 경우, 다음 명령어로 이미지를 빌드합니다.

```
cd data
docker-compose build
```

만약 도커 환경에서 다음 과정을 진행하시는 경우에는, 다음 명령어로 mpk를 실행할 수 있습니다.

```
docker-compose run --rm mpk <args>
```

#### 5.3. 원본 Asset 다운로드

```
pipenv run mpk download
```

다운로드한 Asset은 `data\assets-original`에 저장됩니다.


#### 5.4. 문장 번역 템플릿 생성

```
pipenv run mpk template
```

생성된 템플릿은 `data\translation\translate_en.po`에 저장됩니다.

#### 5.5. 문장 번역 작업 진행

원문 문장 데이터 파일인 `data\translation\translate_en.po`을 복사한 후 같은 폴더에 이름을 `translate_ko.po`로 변경하여 붙여넣습니다.

이후 `data\translation\translate_ko.po` 파일을 [Poedit](https://poedit.net/)과 같은 적절한 편집기로 열어 번역합니다.

#### 5.6. 이미지 리소스 번역

실제 문자열로 저장되어있지 않은 리소스(이미지 등)는 직접 `data\assets-original`에서 복사하여 `data\translation\assets` 폴더에 경로를 잘 지정하여 붙여넣고 직접 수정합니다.
추후 리소스 수정이 용이하도록 가능하면 작업파일(`.psd` 등)을 같이 보관해주세요.

**새로운 리소스를 번역했다면, `resourcepack.json` 파일에 해당 리소스의 경로를 추가하는 것을 잊지 마세요!**

#### 5.7. 텍스처 아틀라스 번역

리소스 중 파일명이 `.atlas`로 끝나는 파일은 텍스처 아틀라스의 구조 정보를 기록하고 있는 파일입니다.

이 정보를 통해 텍스처 아틀라스의 각 이미지를 분리하고 다시 병합할 수 있습니다.

#### 5.7.1. 텍스처 아틀라스 분해 

먼저, 텍스처 아틀라스를 분해하려면 다음과 같은 명령어를 사용합니다.

(텍스처 아틀라스 파일의 경로가 `data\assets-original\res\atlas\en\myres.atlas` 일 경우,)

```
pipenv run mpk atlas unpack assets-original\res\atlas\en\myres.atlas
```

위 예시와 같이 명령어를 사용하면 `data\assets-original\res\atlas\en\myres.atlas_unpack` 폴더가 생성되고, 해당 폴더 안에 각 텍스처 이미지가 저장됩니다.

#### 5.7.2. 텍스처 아틀라스 생성 

이제 분해된 텍스처 이미지를 수정하고 다시 패킹하기 위해서는 다음과 같은 명령어를 입력하시면 됩니다.

```
pipenv run mpk atlas pack data\assets-original\res\atlas\en\myres.atlas_unpack
```

(해당 명령어는 기존 `.atlas` 파일과 실제 텍스처 아틀라스 원본 `.png` 파일들을 덮어씌우니 사용하실 때 원본 파일들을 잘 백업해주세요.)

#### 5.7.3. 텍스처 아틀라스 오프셋 지정

`.atlas_unpack` 폴더 내부의 이미지 파일명에 오프셋 정보를 추가하여 `sourceSize`와 `spriteSourceSize` 값을 변경할 수 있습니다.

원본 이미지 파일명이 `filename.png`일 때, 파일명을 `filename[10,-20,0,0].png`과 같이 변경하여 오프셋을 지정합니다.

대괄호 내의 숫자는 각각 다음의 오프셋을 지정합니다.

- spriteSourceSize의 x 오프셋
- spriteSourceSize의 y 오프셋
- sourceSize의 w 오프셋
- sourceSize의 h 오프셋

예를 들어, 원본 이미지 너비를 30px 늘리고(w offset을 -30으로 지정),
우측으로 20px 이동(x offset을 20으로 지정)하고 싶다면 다음과 같이 파일명을 변경합니다.

```
filename[20,0,-30,0].png
```


#### 5.8. 번역 적용

위와 같이 수정한 번역 내용을 적용하기 위해 리소스 팩을 생성하려면 다음 명령어를 사용합니다.

```
pipenv run mpk build
```

#### 5.9. `majsoul-plus-korean.exe` 파일 갱신

사용자를 위한 `majsoul-plus-korean.exe` 파일을 빌드하려면 다음 명령어를 사용합니다.

```
pipenv run build
```

### 6. 일본 서버용 작업

:warning: 일본 서버용 한국어 번역 리소스는 이 프로젝트에서 현재 제공되지 않습니다. :warning:

`majsoul-plus-korean.exe`의 옵션 중 `--lang`의 값을 `jp`으로 지정하여 스크립트를 실행합니다.

실행 예시는 다음과 같습니다.

```
majsoul-plus-korean.exe --lang jp download
majsoul-plus-korean.exe --lang jp template
majsoul-plus-korean.exe --lang jp build
```

### Contributors

- [Nesswit](https://github.com/rishubil)
- 신짱구
- 일급천재

이외에도 익명의 기여자분들이 번역에 많은 도움을 주셨습니다. 감사합니다.

### License

MIT

또한, 이 프로젝트는 다음의 제3자 소프트웨어 및 폰트의 바이너리를 포함하고 있습니다.

- [fontbm](https://github.com/vladimirgamalyan/fontbm) - BMFont compatible, cross-platform command line bitmap font generator
- [Protocol Buffers](https://github.com/protocolbuffers/protobuf) - Google's data interchange format
- [Noto Sans (CJK)](https://www.google.com/get/noto/)
- [배달의민족 을지로체](https://www.woowahan.com/#/fonts)
- [산돌국대떡볶이체](http://kukde.co.kr/?page_id=627)
- [정묵 바위체](https://sangsangfont.com/21/?idx=122)
